/*
 * FuckAdBlock 4.0.0-beta.2
 * Copyright (c) 2014-2015 Valentin Allaire <valentin.allaire@sitexw.fr>
 * Released under the MIT license
 * https://github.com/sitexw/FuckAdBlock
 */

!function(t,e,o){var n=function(t){this.setOption(t||{})};n.prototype.option=null,n.prototype.setOption=function(t,e){null===this.option&&(this.option={});var o={};"string"!=typeof t&&void 0===e?o=t:o[t]=e;for(var t in o)this.option[t]=o[t];return this},n.prototype.getOption=function(t){if(null===this.option)return void 0;var e=this.option[t];return"function"==typeof e?e(this):e};var i=function(){n.apply(this,arguments),this._data={}};i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.debug=!1,i.prototype._data=null,i.prototype.callbackDetected=null,i.prototype.callbackUndetected=null,i.prototype.setDetected=function(t){return this.callbackDetected=t,this},i.prototype.callDetected=function(){return"function"!=typeof this.callbackDetected?!1:(this.callbackDetected(),this.callbackDetected=null,!0)},i.prototype.setUndetected=function(t){return this.callbackUndetected=t,this},i.prototype.callUndtected=function(){return"function"!=typeof this.callbackUndetected?!1:(this.callbackUndetected(),this.callbackUndetected=null,!0)},i.prototype.name=null,i.prototype.start=null,i.prototype.stop=null;var r=function(){this.setOption({timeout:200}),n.apply(this,arguments),this._event={}};r.prototype=Object.create(n.prototype),r.prototype.constructor=r,r.prototype._version=[4,0,0,"beta",2],r.prototype._event=null,r.prototype.Plugin=i,r.prototype._pluginClass={},r.prototype.registerPlugin=function(t){return void 0===this._pluginClass[t.prototype.name]?(this._pluginClass[t.prototype.name]=t,!0):!1},r.prototype.addEvent=function(t,e){return void 0===this._event[t]&&(this._event[t]=[]),this._event[t].push(e),this},r.prototype.on=function(t,e){return this.addEvent(t===!0?"detected":"undetected",e)},r.prototype.onDetected=function(t){return this.addEvent("detected",t)},r.prototype.onNotDetected=function(t){return this.addEvent("undetected",t)},r.prototype.dispatchEvent=function(t){var e=this._event[t];if(void 0!==e)for(var o in e)e[o]();return this},r.prototype.clearEvent=function(){return this._event={},this},r.prototype.check=function(t,e){t instanceof Array==!1&&void 0===e&&(e=t,t=void 0),void 0===t&&(t=Object.keys(this._pluginClass)),void 0===e&&(e={});var o=this,n={},i=0,r=function(t){if(a++,t===!0||a===i){clearTimeout(d);for(var e in n)n[e].instance.stop();o.dispatchEvent(t===!0?"detected":"undetected")}},a=0;for(var p in t){i++;var s=t[p],c=n[s]={instance:new this._pluginClass[s],detected:null};void 0!==e[s]&&c.instance.setOption(e[s]),c.instance.setDetected(function(){c.detected=!0,r(!0)}).setUndetected(function(){c.detected=!1,r(!1)})}for(var s in n)n[s].instance.start();var d=setTimeout(function(){r(!1)},this.getOption("timeout"));return this};var a=function(){this.setOption({loopTime:50,baitElement:null,baitClass:"pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links",baitStyle:"width:1px!important;height:1px!important;position:absolute!important;left:-10000px!important;top:-1000px!important;"}),r.prototype.Plugin.apply(this,arguments)};a.prototype=Object.create(r.prototype.Plugin.prototype),a.prototype.constructor=a,a.prototype.name="html",a.prototype.start=function(){var t=this;this._data.bait=null===this.getOption("baitElement")?this._createBait({"class":this.getOption("baitClass"),style:this.getOption("baitStyle")}):this.getOption("baitElement");var e=function(){t._checkBait(t._data.bait)===!0&&t.callDetected()};return this._data.loop=setInterval(e,this.getOption("loopTime")),setTimeout(e,1),this},a.prototype.stop=function(){return clearInterval(this._data.loop),t.document.body.removeChild(this._data.bait),this},a.prototype._createBait=function(e){var o=document.createElement("div");return o.setAttribute("class",e["class"]),o.setAttribute("style",e.style),o.offsetParent,o.offsetHeight,o.offsetLeft,o.offsetTop,o.offsetWidth,o.clientHeight,o.clientWidth,o=t.document.body.appendChild(o)},a.prototype._checkBait=function(e){var o=!1;if(null!==t.document.body.getAttribute("abp")||null===e.offsetParent||0==e.offsetHeight||0==e.offsetLeft||0==e.offsetTop||0==e.offsetWidth||0==e.clientHeight||0==e.clientWidth)o=!0;else{var n=t.getComputedStyle(e);("none"==n.getPropertyValue("display")||"hidden"==n.getPropertyValue("visibility"))&&(o=!0)}return o};var p=function(){this.setOption({baitMode:"ajax",baitUrl:"/ad/banner/_adsense_/_adserver/_adview_.ad.json?adzone=top&adsize=300x250&advid={RANDOM}"}),r.prototype.Plugin.apply(this,arguments)};p.prototype=Object.create(r.prototype.Plugin.prototype),p.prototype.constructor=p,p.prototype.name="http",p.prototype.start=function(){var t=this;this._data.end=!1;var e=this.getOption("baitUrl").replace("{RANDOM}",Math.round(1e8*Math.random()));return this._urlCheck(e,this.getOption("baitMode"),function(){t._data.end===!1&&(t._data.end=!0,t.callDetected())},function(){t._data.end===!1&&(t._data.end=!0,t.callUndtected())}),this},p.prototype.stop=function(){return this._data.end=!0,this},p.prototype._urlCheck=function(e,o,n,i){var r=!1,a=function(t){r===!1&&(r=!0,t===!0?n():i())};if("ajax"===o){var p=[!1,!1,!1,!1],s=null,c=function(t){if(void 0!==t)a(t);else{if(0===s)return void a(!0);for(var e=0;4>e;e++)if(p[e]===!1)return void a(!0);a(!1)}},d=new XMLHttpRequest;d.onreadystatechange=function(){p[d.readyState-1]=!0;try{s=d.status}catch(t){}4===d.readyState&&c()};try{d.open("GET",e,!0),d.send()}catch(l){"2153644038"==l.result&&c(!0)}}else if("import"===o){var u=document.createElement("script");u.src=e,u.onerror=function(){a(!0),t.document.body.removeChild(u)},u.onload=function(){a(!1),t.document.body.removeChild(u)},t.document.body.appendChild(u)}else a(!1)},r.prototype.registerPlugin(a),r.prototype.registerPlugin(p),t[o]=r,void 0===t[e]&&(t[e]=new r,t.addEventListener("load",function(){setTimeout(function(){t[e].check()},1)},!1))}(window,"fuckAdBlock","FuckAdBlock");
